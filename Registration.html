<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> GJ Tech Form with Fee</title>
  <style>
    /* Basic CSS for form styling */
    body {
      font-family: 'Inter', Arial, sans-serif; /* Using Inter font as per guidelines */
      background: #f0f0f0;
      display: flex;
      flex-direction: column; /* Changed to column to stack elements */
      justify-content: flex-start; /* Align items to the start of the column */
      align-items: center; /* Center horizontally */
      min-height: 100vh; /* Ensure it takes full viewport height */
      margin: 0;
      padding: 0; /* Remove body padding as elements will handle their own */
      box-sizing: border-box;
    }
    /* Styles for the announcement marquee */
    .announcement-marquee {
      width: 100%;
      background-color: #e7e729; /* Light red background */
      color: #2552e5; /* Dark red text */
      padding: 8px 0;
      font-size: 0.9em;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 15px; /* Space below marquee */
    }
    .announcement-marquee marquee {
      white-space: nowrap; /* Ensure text stays on one line */
      overflow: hidden;
      box-sizing: border-box;
    }
    .announcement-marquee a {
      color: #721c24;
      text-decoration: underline;
      margin: 0 10px;
    }
    /* Styles for the navigation bar (based on Tailwind-like classes) */
    .nav-bar {
      background-color: #334155; /* Equivalent to bg-slate-700 */
      color: white;
      text-align: center;
      padding: 12px 0; /* py-3 */
      display: flex;
      justify-content: center;
      flex-wrap: wrap; /* Allow items to wrap on smaller screens */
      gap: 12px; /* space-x-3 md:space-x-6 */
      font-size: 0.875rem; /* text-sm */
      position: sticky;
      top: 0;
      z-index: 50;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      width: 100%;
    }
    .nav-bar a {
      color: white;
      text-decoration: none;
      padding: 5px 10px;
      border-radius: 5px;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    .nav-bar a:hover {
      background-color: #475569; /* A slightly lighter slate for hover */
      color: #e2e8f0;
    }
    /* Media queries for navigation bar responsiveness */
    @media (min-width: 768px) { /* md breakpoint */
      .nav-bar {
        font-size: 1.125rem; /* text-lg */
        gap: 24px; /* md:space-x-6 */
      }
    }
    .form-container {
      background: white;
      padding: 30px;
      border-radius: 12px; /* Rounded corners */
      box-shadow: 0 4px 20px rgba(0,0,0,0.1); /* Enhanced shadow */
      width: 100%; /* Make it fluid */
      max-width: 400px; /* Max width for larger screens */
      box-sizing: border-box;
      margin-top: 20px; /* Space below navigation bar */
      margin-bottom: 20px; /* Space at the bottom */
    }
    h2 {
      text-align: center;
      margin-bottom: 25px;
      color: #333;
      font-size: 1.8em;
    }
    label {
      font-weight: 600; /* Slightly bolder */
      margin-top: 15px;
      margin-bottom: 5px;
      display: block;
      color: #555;
    }
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="password"],
    input[type="file"] {
      display: block;
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      font-size: 16px;
      border: 1px solid #ddd;
      border-radius: 8px; /* Rounded corners for inputs */
      box-sizing: border-box; /* Include padding and border in the element's total width and height */
      transition: border-color 0.3s ease;
    }
    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="tel"]:focus,
    input[type="password"]:focus,
    input[type="file"]:focus {
      border-color: #0e76a8; /* Highlight on focus */
      outline: none;
    }
    input[type="file"] {
      padding: 8px; /* Adjust padding for file input */
    }
    p {
      font-weight: bold;
      text-align: center;
      margin-top: 25px;
      color: #0e76a8; /* Emphasize fee */
      font-size: 1.1em;
    }
    button {
      margin-top: 20px;
      padding: 14px;
      width: 100%;
      background-color: #0e76a8;
      color: white;
      border: none;
      border-radius: 8px; /* Rounded corners for button */
      cursor: pointer;
      font-size: 18px;
      font-weight: bold;
      transition: background-color 0.3s ease, transform 0.2s ease;
      box-shadow: 0 4px 10px rgba(14, 118, 168, 0.3); /* Button shadow */
    }
    button:hover {
      background-color: #0b5a80;
      transform: translateY(-2px); /* Slight lift effect on hover */
    }
    button:active {
      transform: translateY(0); /* Press down effect */
    }
    /* Responsive adjustments */
    @media (max-width: 600px) {
      .form-container {
        padding: 20px;
        margin: 10px;
      }
      h2 {
        font-size: 1.5em;
      }
      button {
        font-size: 16px;
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="announcement-marquee">
    <marquee behavior="scroll" direction="left" scrollamount="5">
      üöÄ Welcome to GJ Tech! New projects coming soon!
      <a href="blogs.html">Check out our latest blog posts</a> |
      <a href="contact.html">Join our tech community</a> |
      <a href="about.html">Learn more about our mission</a> |
      <a href="careergoals.html">Career Goals and Opportunities</a>
    </marquee>
  </div>
  <nav class="nav-bar">
    <a href="index.html">Home üè°</a>
    <a href="blogs.html">Blogs üë©‚Äçüíª</a>
    <a href="about.html">About üéì</a>
    <a href="contact.html">Contact üì∂/Explore Our Courses</a>
    <a href="careergoals.html">Career Goals</a>
    <a href="CoursesinManagement.html">Courses in Management</a>
    <a href="Registration.html">Registration-in</a>
    <a href="login.html">Login-in</a>
  </nav>
  <div class="form-container">
    <h2>Registration Form</h2>
    <form id="applicationForm">
      <label for="name">Full Name</label>
      <input type="text" id="name" required>
      <label for="email">Email</label>
      <input type="email" id="email" required>
      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" required>
      <label for="password">Password</label>
      <input type="password" id="password" required>
      <label for="confirmPassword">Confirm Password</label>
      <input type="password" id="confirmPassword" required>
      <label for="photo">Upload Photo</label>
      <input type="file" id="photo" accept="image/*" required>
      <label for="signature">Upload Signature</label>
      <input type="file" id="signature" accept="image/*" required>
      <p>Application Fee: ‚Çπ100</p>
      <button type="button" onclick="payAndSubmit()">Pay & Submit</button>
    </form>
  </div>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script>
    async function payAndSubmit() {
      // Get form field values
      const name = document.getElementById("name").value.trim();
      const email = document.getElementById("email").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const password = document.getElementById("password").value;
      const confirmPassword = document.getElementById("confirmPassword").value;
      const photoFile = document.getElementById("photo").files[0]; // Get the actual File object
      const signatureFile = document.getElementById("signature").files[0]; // Get the actual File object
      // --- Client-side Form Validation ---
      if (!name || !email || !phone || !password || !confirmPassword || !photoFile || !signatureFile) {
        alert("Please fill all fields and upload required files.");
        return;
      }
      if (password !== confirmPassword) {
        alert("Passwords do not match. Please re-enter.");
        return;
      }
      if (password.length < 6) { // Example: minimum password length validation
        alert("Password must be at least 6 characters long.");
        return;
      }
      // Basic email format validation (more robust validation should be on the backend)
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        alert("Please enter a valid email address.");
        return;
      }
      // Basic phone number validation (e.g., for 10 digits)
      const phoneRegex = /^\d{10}$/; // Assumes 10-digit Indian phone number
      if (!phoneRegex.test(phone)) {
          alert("Please enter a valid 10-digit phone number.");
          return;
      }
      // Create a FormData object to send both text data and files to the backend
      const formData = new FormData();
      formData.append('name', name);
      formData.append('email', email);
      formData.append('phone', phone);
      formData.append('password', password); // Password will be hashed on the backend
      formData.append('photo', photoFile); // Append the photo file
      formData.append('signature', signatureFile); // Append the signature file
      // --- Razorpay Payment Integration ---
      const options = {
        key: "YOUR_RAZORPAY_KEY_ID", // üö® IMPORTANT: Replace with your actual Razorpay Key ID
                                     // This is a public key, safe to use on the frontend.
        amount: 10000, // Amount in paise (e.g., 100 INR = 10000 paise)
        currency: "INR",
        name: "GJ Tech",
        description: "Application Fee Payment",
        image: "https://placehold.co/60x60/0e76a8/ffffff?text=GJ", // Optional: Your company logo
        handler: async function (response) {
          // This function is called when the payment is successful
          alert("Payment Successful!\nPayment ID: " + response.razorpay_payment_id);
          // Append the Razorpay payment ID to the formData
          formData.append('razorpayPaymentId', response.razorpay_payment_id);
          // --- Send Form Data to Backend After Successful Payment ---
          try {
            // Make a POST request to your Node.js backend endpoint
            // Ensure this URL matches the port your backend server is running on (e.g., 3000)
            const backendResponse = await fetch('http://localhost:3000/submit-application', {
              method: 'POST',
              body: formData, // FormData automatically sets the correct 'Content-Type' header (multipart/form-data)
            });
            const data = await backendResponse.json(); // Parse the JSON response from the backend
            if (backendResponse.ok) { // Check if the backend response status is in the 2xx range (success)
              alert(data.message + "\nYour Application ID: " + data.applicationId);
              // Optionally, clear the form or redirect the user after successful submission
              document.getElementById("applicationForm").reset();
            } else {
              // Handle errors returned by the backend (e.g., validation issues, duplicate entries)
              alert("Error submitting application to backend: " + data.message);
              console.error('Backend Error Details:', data.error);
            }
          } catch (error) {
            // Handle network errors or issues with the backend server itself
            console.error('Network or server error during form submission:', error);
            alert('A network error occurred while saving your application. Please try again.');
          }
        },
        prefill: {
          name: name,
          email: email,
          contact: phone
        },
        theme: {
          color: "#0e76a8" // Customize Razorpay checkout theme color
        }
      };
      const rzp = new Razorpay(options);
      // Handle payment failure events
      rzp.on('payment.failed', function (response){
        alert("Payment Failed! Reason: " + response.error.description + "\nPlease try again or contact support.");
        console.error("Razorpay Payment Error:", response.error);
      });
      rzp.open(); // Open the Razorpay checkout modal
    }
  </script>
</body>
</html>