<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GJ Tech Company -HTML Test</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-dark: #1d4ed8;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --text-color: #1f2937;
            --text-light: #6b7280;
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --border-color: #e5e7eb;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
        }
        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }
        h1 {
            text-align: center;
            color: white;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        h2 {
            color: var(--primary-color);
            font-size: 1.875rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            text-align: center;
        }
        h3 {
            color: var(--text-color);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            min-height: 44px;
            gap: 8px;
            box-shadow: var(--shadow-sm);
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
        }
        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #059669);
            color: white;
        }
        .btn-success:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        .btn-error {
            background: linear-gradient(135deg, var(--error-color), #dc2626);
            color: white;
        }
        .btn-error:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.3);
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-label {
            display: block;
            font-weight: 500;
            color: var(--text-color);
            margin-bottom: 0.5rem;
        }
        .form-input, .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }
        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        .form-error {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.25rem;
            display: none;
        }
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .question-counter {
            background: var(--primary-color);
            color: white;
            padding: 8px 16px;
            border-radius: 50px;
            font-weight: 500;
        }
        .ai-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 6px 12px;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .timer {
            background: linear-gradient(135deg, var(--error-color), #dc2626);
            color: white;
            padding: 12px 20px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .question-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }
        .answer-input {
            margin-bottom: 2rem;
        }
        .checking-animation {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 20px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 8px;
            margin: 20px 0;
        }
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .video-container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding: 1rem;
            margin-bottom: 2rem;
        }
        .camera-feed {
            max-width: 160px;
            height: 120px;
            width: auto;
            border: 3px solid var(--primary-color);
            border-radius: var(--border-radius);
            object-fit: cover;
            background: #000;
            box-shadow: var(--shadow-md);
            margin-bottom: 0.5rem;
        }
        .camera-status {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 8px;
            margin-top: 0;
            padding: 8px 16px;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--success-color);
            border-radius: 50px;
            color: var(--success-color);
            font-weight: 500;
            max-width: fit-content;
            margin-left: 0;
        }
        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--success-color);
            border-radius: 50%;
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--error-color);
        }
        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: var(--success-color);
        }
        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: var(--warning-color);
        }
        .certificate {
            background: linear-gradient(135deg, #fef7ff, #f3e8ff);
            border: 3px solid var(--primary-color);
            text-align: center;
            padding: 3rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            border-radius: var(--border-radius);
        }
        .certificate::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(37, 99, 235, 0.03) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .certificate-content {
            position: relative;
            z-index: 1;
        }
        .certificate-title {
            font-family: 'Great Vibes', cursive;
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 2rem;
        }
        .hidden {
            display: none !important;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0px); }
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 2rem;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        .ai-feedback {
            background: #f8f9ff;
            border: 1px solid #e0e7ff;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        .score-display {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border-radius: 50px;
            font-weight: 500;
            display: inline-block;
            margin: 0 10px;
        }
        .pdf-certificate {
            position: absolute;
            left: -9999px;
            opacity: 0;
            font-family: 'Inter', sans-serif;
            width: 210mm;
            height: 297mm;
            padding: 20mm;
            background: white;
            box-sizing: border-box;
            color: #1f2937;
            display: block !important;
        }
        .pdf-certificate h1 {
            color: #2563eb;
            font-size: 24pt;
            text-align: center;
            margin-bottom: 0;
        }
        .pdf-certificate h2 {
            font-family: 'Great Vibes', cursive;
            font-size: 36pt;
            color: #2563eb;
            margin-bottom: 20px;
            text-align: center;
        }
        .pdf-certificate p {
            font-size: 14pt;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        .pdf-certificate strong {
            font-weight: 700;
        }
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .quiz-option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }
        .quiz-option:hover {
            border-color: var(--primary-color);
        }
        .quiz-option input[type="radio"] {
            margin-right: 1rem;
            transform: scale(1.2);
        }
        .correct {
            border-color: var(--success-color);
            background: rgba(16, 185, 129, 0.1);
        }
        .incorrect {
            border-color: var(--error-color);
            background: rgba(239, 68, 68, 0.1);
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 1rem;
            }
            h1 {
                font-size: 2rem;
            }
            .card {
                padding: 1.5rem;
            }
            .quiz-header {
                flex-direction: column;
                align-items: stretch;
            }
            .quiz-header > div {
                width: 100%;
                text-align: center;
            }
            .camera-feed {
                max-width: 100%;
                height: 150px;
            }
            .certificate-title {
                font-size: 2rem;
            }
            .btn {
                width: 100%;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <h1>AI-Powered HTML Test</h1>
    <div class="container">
        <div id="test-info" class="card fade-in">
            <h2>Welcome to the AI-Powered HTML Test</h2>
            <p style="text-align: center; margin-bottom: 2rem; color: var(--text-light);">
                Experience intelligent assessment with AI-powered answer evaluation
            </p>
            <div style="background: rgba(37, 99, 235, 0.1); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                <h3 style="margin-bottom: 1rem;">AI-Enhanced Test Instructions</h3>
                <ul style="padding-left: 1.5rem; color: var(--text-color);">
                    <li>This test consists of <strong id="total-questions-display"></strong> HTML-related questions</li>
                    <li>Answers are evaluated by AI for comprehensive assessment</li>
                    <li>You have <strong id="test-duration-display"></strong> minutes to complete the test</li>
                    <li>Provide detailed answers - AI rewards thorough explanations</li>
                    <li>Camera monitoring is active throughout the test</li>
                    <li>Do not switch tabs or applications during the test</li>
                    <li>A passing score of <strong>70%</strong> is required for certification</li>
                </ul>
            </div>
            <div style="background: rgba(16, 185, 129, 0.05); padding: 2rem; border-radius: 12px; border: 1px solid rgba(16, 185, 129, 0.2);">
                <h3 style="text-align: center; margin-bottom: 1.5rem;">👤 Enter Your Details</h3>
                <div class="form-group">
                    <label class="form-label" for="name-input">Full Name</label>
                    <input type="text" id="name-input" class="form-input" placeholder="Enter your full name">
                    <div id="name-error" class="form-error">Please enter your full name</div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="father-name-input">Father's Name</label>
                    <input type="text" id="father-name-input" class="form-input" placeholder="Enter your father's name">
                    <div id="father-name-error" class="form-error">Please enter your father's name</div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="district-input">District</label>
                    <input type="text" id="district-input" class="form-input" placeholder="Enter your district">
                    <div id="district-error" class="form-error">Please enter your district</div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="state-input">State</label>
                    <input type="text" id="state-input" class="form-input" placeholder="Enter your state">
                    <div id="state-error" class="form-error">Please enter your state</div>
                </div>
                <div style="text-align: center; margin-top: 2rem;">
                    <button id="start-btn" class="btn btn-primary">
                        🚀 Start AI Test
                    </button>
                </div>
            </div>
        </div>
        <div id="quiz-section" class="hidden">
            <div class="card">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                </div>
                <div class="quiz-header">
                    <div id="question-counter" class="question-counter">Question 1 of 10</div>
                    <div class="ai-badge">🤖 AI Powered</div>
                    <div id="timer" class="timer">⏰ 20:00</div>
                </div>
                <div id="question-text" class="question-text"></div>
                <div id="quiz-options" class="quiz-options">
                    </div>
                <div id="checking-animation" class="checking-animation hidden">
                    <div class="spinner"></div>
                    <span>AI is evaluating your answer...</span>
                </div>
                <div id="result-message" class="hidden"></div>
                <div id="ai-feedback" class="ai-feedback hidden"></div>

                <div style="text-align: center; margin-top: 2rem; display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center;">
                    <button id="submit-answer-btn" class="btn btn-primary">Submit Answer</button>
                    <button id="next-btn" class="btn btn-success hidden">Next Question →</button>
                </div>
            </div>
            <div class="card video-container">
                <h3>📹 Proctoring Camera</h3>
                <video id="camera-feed" class="camera-feed" autoplay playsinline muted></video>
                <div id="camera-status" class="camera-status">
                    <div class="status-dot"></div>
                    <span>Camera Active - Test Monitored</span>
                </div>
            </div>
        </div>
        <div id="results-section" class="hidden">
            <div class="card">
                <div id="final-result"></div>
            </div>
            <div id="certificate-section" class="hidden">
                <div class="certificate">
                    <div class="certificate-content">
                        <div class="certificate-title">Certificate of Completion</div>
                        <p style="font-size: 1.2rem; margin-bottom: 1rem;">This certifies that</p>
                        <h3 id="cert-name" style="color: var(--primary-color); font-size: 2rem; margin-bottom: 1rem;"></h3>
                        <p style="font-size: 1.1rem; margin-bottom: 2rem;">has successfully completed the AI-Powered HTML Test</p>
                        <p><strong>Score: <span id="cert-score"></span>%</strong></p>
                        <p><strong>Date: <span id="cert-date"></span></strong></p>
                        <div style="margin-top: 2rem;">
                            <button id="download-btn" class="btn btn-success">
                                📄 Download Certificate
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="cheat-alert" class="alert alert-error hidden">
            <strong>⚠️ Suspicious Activity Detected!</strong><br>
            The test has been terminated due to potential cheating behavior.
            <div style="margin-top: 1rem; text-align: center;">
                <button id="acknowledge-btn" class="btn btn-error">Acknowledge</button>
            </div>
        </div>
    </div>
    <div id="pdf-certificate" class="pdf-certificate">
        <div style="text-align: center; border-bottom: 2px solid #2563eb; padding-bottom: 20px; margin-bottom: 30px;">
            <h1>GJ Tech Company Pvt Ltd.</h1>
            <p style="color: #666; font-size: 12pt;">AI-Powered Professional Certification Program</p>
        </div>
        <div style="text-align: center; margin: 40px 0;">
            <h2>Certificate of Completion</h2>
        </div>
        <div style="font-size: 14pt; line-height: 1.6; margin: 30px 0;">
            <p>This is to certify that <strong id="pdf-cert-name"></strong>,</p>
            <p>Son/Daughter of <strong id="pdf-cert-father"></strong>,</p>
            <p>Resident of <strong id="pdf-cert-district"></strong>, <strong id="pdf-cert-state"></strong>,</p>
            <p>has successfully completed the <strong>AI-Powered HTML Certification Program</strong> conducted by GJ Tech Company Pvt Ltd.</p>
        </div>
        <div style="text-align: center; margin: 40px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
            <p style="font-size: 18pt; color: #10b981;"><strong>Score: <span id="pdf-cert-score"></span>%</strong></p>
            <p style="font-size: 12pt;">Date of Completion: <span id="pdf-cert-date"></span></p>
            <p style="font-size: 10pt; color: #666;">Evaluated using Advanced AI Assessment Technology</p>
        </div>
        <div style="display: flex; justify-content: space-between; margin-top: 60px;">
            <div style="text-align: center;">
                <div style="border-bottom: 1px solid #000; width: 150px; margin-bottom: 5px;"></div>
                <p style="font-size: 10pt;">Authorized Signature</p>
            </div>
            <div style="text-align: center;">
                <div style="border-bottom: 1px solid #000; width: 150px; margin-bottom: 5px;"></div>
                <p style="font-size: 10pt;">Company Seal</p>
            </div>
        </div>
    </div>
    <script>
        const testInfoEl = document.getElementById('test-info');
        const quizSectionEl = document.getElementById('quiz-section');
        const resultsSectionEl = document.getElementById('results-section');
        const questionCounterEl = document.getElementById('question-counter');
        const timerEl = document.getElementById('timer');
        const questionTextEl = document.getElementById('question-text');
        const quizOptionsEl = document.getElementById('quiz-options');
        const submitBtn = document.getElementById('submit-answer-btn');
        const nextBtn = document.getElementById('next-btn');
        const checkingAnimEl = document.getElementById('checking-animation');
        const aiFeedbackEl = document.getElementById('ai-feedback');
        const finalResultEl = document.getElementById('final-result');
        const certificateSectionEl = document.getElementById('certificate-section');
        const downloadBtn = document.getElementById('download-btn');
        const nameInput = document.getElementById('name-input');
        const fatherNameInput = document.getElementById('father-name-input');
        const districtInput = document.getElementById('district-input');
        const stateInput = document.getElementById('state-input');
        const startBtn = document.getElementById('start-btn');
        const progressFill = document.getElementById('progress-fill');
        const cameraFeed = document.getElementById('camera-feed');
        const totalQuestionsDisplay = document.getElementById('total-questions-display');
        const testDurationDisplay = document.getElementById('test-duration-display');
        const cheatAlertEl = document.getElementById('cheat-alert');
        const acknowledgeBtn = document.getElementById('acknowledge-btn');
        let currentQuestionIndex = 0;
        let totalScore = 0;
        let timeRemaining = 1200; 
        let quizTimer = null;
        let stream = null;
        let quizActive = false;
        let userDetails = {};
        const PASSING_SCORE_PERCENTAGE = 70;
        const MAX_SCORE_PER_QUESTION = 10;
        const TAB_SWITCH_WARNINGS = 0; 
        const questions = [
            {
                question: "What does HTML stand for?",
                topic: "HTML Basics",
                options: [
                    "A) Hyper Text Markup Language",
                    "B) Hyperlinks and Text Markup Language",
                    "C) Home Tool Markup Language",
                    "D) Hyper Transfer Markup Language"
                ],
                correctAnswer: "A) Hyper Text Markup Language",
                idealAnswerKeywords: ["Hyper Text Markup Language", "standard markup language", "web pages", "structure", "elements", "tags"]
            },
            {
                question: "Which HTML tag is used to define an internal style sheet?",
                topic: "Styling HTML",
                options: [
                    "A) <script>",
                    "B) <css>",
                    "C) <style>",
                    "D) <link>"
                ],
                correctAnswer: "C) <style>",
                idealAnswerKeywords: ["<style>", "internal stylesheet", "within the head section", "inline styles"]
            },
            {
                question: "Which HTML attribute is used to define inline styles?",
                topic: "HTML Attributes",
                options: [
                    "A) font",
                    "B) class",
                    "C) styles",
                    "D) style"
                ],
                correctAnswer: "D) style",
                idealAnswerKeywords: ["style attribute", "inline styles", "single element", "styling"]
            },
            {
                question: "Which is the correct HTML element for inserting a line break?",
                topic: "HTML Elements",
                options: [
                    "A) <lb>",
                    "B) <break>",
                    "C) <br>",
                    "D) <newline>"
                ],
                correctAnswer: "C) <br>",
                idealAnswerKeywords: ["<br>", "line break", "empty tag", "no closing tag"]
            },
            {
                question: "Which HTML element is used to specify a footer for a document or section?",
                topic: "HTML5 Semantic Elements",
                options: [
                    "A) <bottom>",
                    "B) <footer>",
                    "C) <end>",
                    "D) <section>"
                ],
                correctAnswer: "B) <footer>",
                idealAnswerKeywords: ["<footer>", "semantic element", "footer content", "bottom of page", "section"]
            },
            {
                question: "How do you make an ordered list in HTML?",
                topic: "HTML Lists",
                options: [
                    "A) <ol>",
                    "B) <ul>",
                    "C) <li>",
                    "D) <list>"
                ],
                correctAnswer: "A) <ol>",
                idealAnswerKeywords: ["<ol>", "ordered list", "numbered list", "<li>"]
            },
            {
                question: "Which element causes text to be italicized in HTML?",
                topic: "Text Formatting",
                options: [
                    "A) <i>",
                    "B) <italic>",
                    "C) <it>",
                    "D) <pre>"
                ],
                correctAnswer: "A) <i>",
                idealAnswerKeywords: ["<i>", "italic text", "stylistic", "alternative voice"]
            },
            {
                question: "How do you insert an image in HTML?",
                topic: "Images in HTML",
                options: [
                    "A) <img href='image.png' />",
                    "B) <img url='image.png' />",
                    "C) <img link='image.png' />",
                    "D) <img src='image.png' />"
                ],
                correctAnswer: "D) <img src='image.png' />",
                idealAnswerKeywords: ["<img>", "src attribute", "source", "alt attribute", "alternative text"]
            },
            {
                question: "Which tag is used for the largest heading in HTML?",
                topic: "HTML Headings",
                options: [
                    "A) <h6>",
                    "B) <heading>",
                    "C) <h1>",
                    "D) <header>"
                ],
                correctAnswer: "C) <h1>",
                idealAnswerKeywords: ["<h1>", "largest heading", "most important heading", "six heading levels"]
            },
            {
                question: "What is the correct HTML for creating a hyperlink?",
                topic: "Hyperlinks",
                options: [
                    "A) <a url='http://example.com'>Link</a>",
                    "B) <a href='http://example.com'>Link</a>",
                    "C) <link>http://example.com</link>",
                    "D) <a>http://example.com</a>"
                ],
                correctAnswer: "B) <a href='http://example.com'>Link</a>",
                idealAnswerKeywords: ["<a>", "href attribute", "hyperlink", "anchor tag"]
            },
            {
                question: "Which HTML tag is used to create a table?",
                topic: "HTML Tables",
                options: [
                    "A) <table>",
                    "B) <tab>",
                    "C) <tr>",
                    "D) <td>"
                ],
                correctAnswer: "A) <table>",
                idealAnswerKeywords: ["<table>", "table element", "<tr>", "<td>", "<th>"]
            },
            {
                question: "What does the <input> tag represent?",
                topic: "HTML Forms",
                options: [
                    "A) A format tag",
                    "B) An empty tag",
                    "C) A container tag",
                    "D) None of the above"
                ],
                correctAnswer: "B) An empty tag",
                idealAnswerKeywords: ["<input>", "form input", "empty element", "user data"]
            },
            {
                question: "Which tag is used for underlined text?",
                topic: "Text Formatting",
                options: [
                    "A) <u>",
                    "B) <i>",
                    "C) <ul>",
                    "D) <pre>"
                ],
                correctAnswer: "A) <u>",
                idealAnswerKeywords: ["<u>", "underlined text", "Deprecated tag", "CSS text-decoration"]
            },
            {
                question: "What is the HTML code for a checkbox?",
                topic: "HTML Forms",
                options: [
                    "A) <input type='checkbox'>",
                    "B) <input type='button'>",
                    "C) <input type='check'>",
                    "D) <checkbox>"
                ],
                correctAnswer: "A) <input type='checkbox'>",
                idealAnswerKeywords: ["<input>", "type attribute", "checkbox", "form elements"]
            },
            {
                question: "HTML tags are surrounded by which characters?",
                topic: "HTML Syntax",
                options: [
                    "A) < and >",
                    "B) { and }",
                    "C) # and #",
                    "D) ! and ?"
                ],
                correctAnswer: "A) < and >",
                idealAnswerKeywords: ["angle brackets", "tags", "syntax", "elements"]
            }
        ];
        const totalQuestionsCount = questions.length;
        class AIAnswerEvaluator {
            async evaluateAnswer(question, userAnswer, topic, idealKeywords) {
                console.log("Simulating AI evaluation...");
                let score = 0;
                let feedback = "";
                let overallFeedback = "";
                const isCorrect = userAnswer.includes(questions[currentQuestionIndex].correctAnswer.split(')')[0]);
                if (isCorrect) {
                    score = MAX_SCORE_PER_QUESTION;
                    feedback = `Excellent! Your choice is correct. You have a strong understanding of HTML basics.`;
                    overallFeedback = "Outstanding!";
                } else {
                    score = Math.floor(Math.random() * 4) + 1; 
                    const correctChoice = questions[currentQuestionIndex].correctAnswer;
                    feedback = `Your answer was incorrect. The correct answer is **${correctChoice}**. Study the topic of ${topic} to improve.`;
                    overallFeedback = "Needs improvement.";
                }
                await new Promise(resolve => setTimeout(resolve, 2000));
                return {
                    score,
                    feedback,
                    overallFeedback,
                    maxScore: MAX_SCORE_PER_QUESTION
                };
            }
        }
        const aiEvaluator = new AIAnswerEvaluator();
        startBtn.addEventListener('click', startQuiz);
        submitBtn.addEventListener('click', submitAnswer);
        nextBtn.addEventListener('click', nextQuestion);
        downloadBtn.addEventListener('click', downloadCertificate);
        acknowledgeBtn.addEventListener('click', () => {
            cheatAlertEl.classList.add('hidden');
        });
        let tabSwitches = 0;
        document.addEventListener('visibilitychange', () => {
            if (quizActive && document.visibilityState === 'hidden') {
                tabSwitches++;
                if (tabSwitches >= TAB_SWITCH_WARNINGS) {
                    terminateTest("Suspicious activity detected (switched tabs).");
                }
            }
        });
        document.addEventListener('DOMContentLoaded', () => {
            totalQuestionsDisplay.textContent = totalQuestionsCount;
            testDurationDisplay.textContent = timeRemaining / 60;
        });
        function validateForm() {
            let isValid = true;
            const inputs = [
                { id: 'name-input', error: 'name-error' },
                { id: 'father-name-input', error: 'father-name-error' },
                { id: 'district-input', error: 'district-error' },
                { id: 'state-input', error: 'state-error' }
            ];
            inputs.forEach(item => {
                const inputEl = document.getElementById(item.id);
                const errorEl = document.getElementById(item.error);
                if (inputEl.value.trim() === '') {
                    errorEl.style.display = 'block';
                    isValid = false;
                } else {
                    errorEl.style.display = 'none';
                }
            });

            return isValid;
        }
        async function startQuiz() {
            if (!validateForm()) {
                alert("Please fill in all your details to start the test.");
                return;
            }
            userDetails.name = nameInput.value.trim();
            userDetails.fatherName = fatherNameInput.value.trim();
            userDetails.district = districtInput.value.trim();
            userDetails.state = stateInput.value.trim();
            testInfoEl.classList.add('hidden');
            quizSectionEl.classList.remove('hidden');
            quizSectionEl.classList.add('fade-in');
            try {
                stream = await navigator.mediaDevices.getUserMedia({ video: true });
                cameraFeed.srcObject = stream;
            } catch (err) {
                console.error("Camera access denied: ", err);
                const cameraStatusEl = document.getElementById('camera-status');
                cameraStatusEl.innerHTML = `<span style="color:var(--error-color);">Camera access denied!</span>`;
            }
            quizActive = true;
            startTimer();
            loadQuestion();
        }
        function startTimer() {
            quizTimer = setInterval(() => {
                timeRemaining--;
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                timerEl.textContent = `⏰ ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                if (timeRemaining <= 0) {
                    clearInterval(quizTimer);
                    terminateTest("Time's up!");
                }
            }, 1000);
        }
        function terminateTest(reason) {
            quizActive = false;
            clearInterval(quizTimer);
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            quizSectionEl.classList.add('hidden');
            cheatAlertEl.classList.remove('hidden');
            console.error(reason);
        }
        function loadQuestion() {
            if (currentQuestionIndex >= totalQuestionsCount) {
                showResults();
                return;
            }
            const questionData = questions[currentQuestionIndex];
            questionCounterEl.textContent = `Question ${currentQuestionIndex + 1} of ${totalQuestionsCount}`;
            questionTextEl.textContent = questionData.question;
            quizOptionsEl.innerHTML = '';
            aiFeedbackEl.classList.add('hidden');
            aiFeedbackEl.textContent = '';
            submitBtn.disabled = false;
            submitBtn.classList.remove('hidden');
            nextBtn.classList.add('hidden');
            questionData.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.classList.add('quiz-option');
                optionDiv.innerHTML = `
                    <input type="radio" name="answer" id="option${index}" value="${option}">
                    <label for="option${index}">${option}</label>
                `;
                quizOptionsEl.appendChild(optionDiv);
            });
            updateProgressBar();
        }
        async function submitAnswer() {
            const selectedOptionEl = document.querySelector('input[name="answer"]:checked');
            if (!selectedOptionEl) {
                alert("Please select an answer before submitting.");
                return;
            }
            submitBtn.disabled = true;
            checkingAnimEl.classList.remove('hidden');
            const userAnswer = selectedOptionEl.value;
            const currentQuestionData = questions[currentQuestionIndex];
            const evaluation = await aiEvaluator.evaluateAnswer(
                currentQuestionData.question,
                userAnswer,
                currentQuestionData.topic,
                currentQuestionData.idealAnswerKeywords
            );
            checkingAnimEl.classList.add('hidden');
            aiFeedbackEl.classList.remove('hidden');
            totalScore += evaluation.score;
            aiFeedbackEl.innerHTML = `
                <strong>AI Feedback:</strong><br>
                <strong>Score:</strong> <span class="score-display">${evaluation.score}/${evaluation.maxScore}</span><br>
                ${evaluation.feedback}
            `;
            const options = quizOptionsEl.querySelectorAll('.quiz-option');
            options.forEach(option => {
                const radio = option.querySelector('input');
                if (radio.value === currentQuestionData.correctAnswer) {
                    option.classList.add('correct');
                } else if (radio.checked) {
                    option.classList.add('incorrect');
                }
                radio.disabled = true; 
            });
            submitBtn.classList.add('hidden');
            nextBtn.classList.remove('hidden');
        }
        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }
        function updateProgressBar() {
            const progress = (currentQuestionIndex / totalQuestionsCount) * 100;
            progressFill.style.width = `${progress}%`;
        }
        function showResults() {
            quizActive = false;
            clearInterval(quizTimer);
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            quizSectionEl.classList.add('hidden');
            resultsSectionEl.classList.remove('hidden');
            resultsSectionEl.classList.add('fade-in');
            const finalPercentage = Math.floor((totalScore / (totalQuestionsCount * MAX_SCORE_PER_QUESTION)) * 100);
            const isPassed = finalPercentage >= PASSING_SCORE_PERCENTAGE;
            let resultMessage = `<h2>Final Results</h2>`;
            resultMessage += `<p style="text-align: center; font-size: 1.25rem;">Your final score is: <span class="score-display">${finalPercentage}%</span></p>`;
            if (isPassed) {
                resultMessage += `<div class="alert alert-success" style="text-align: center; margin-top: 1.5rem;">🎉 Congratulations! You have passed the test.</div>`;
                certificateSectionEl.classList.remove('hidden');
                populateCertificate(finalPercentage);
            } else {
                resultMessage += `<div class="alert alert-error" style="text-align: center; margin-top: 1.5rem;">😔 Unfortunately, you did not pass. A score of ${PASSING_SCORE_PERCENTAGE}% is required.</div>`;
                certificateSectionEl.classList.add('hidden');
            }
            finalResultEl.innerHTML = resultMessage;
        }
        function populateCertificate(score) {
            const date = new Date().toLocaleDateString('en-IN', {
                year: 'numeric', month: 'long', day: 'numeric'
            });
            document.getElementById('cert-name').textContent = userDetails.name;
            document.getElementById('cert-score').textContent = score;
            document.getElementById('cert-date').textContent = date;
            document.getElementById('pdf-cert-name').textContent = userDetails.name;
            document.getElementById('pdf-cert-father').textContent = userDetails.fatherName;
            document.getElementById('pdf-cert-district').textContent = userDetails.district;
            document.getElementById('pdf-cert-state').textContent = userDetails.state;
            document.getElementById('pdf-cert-score').textContent = score;
            document.getElementById('pdf-cert-date').textContent = date;
        }
        function downloadCertificate() {
            populateCertificate(Math.floor((totalScore / (totalQuestionsCount * MAX_SCORE_PER_QUESTION)) * 100));
            const element = document.getElementById('pdf-certificate');
            const options = {
                margin: 10,
                filename: `GJTech_Certificate_${userDetails.name.replace(/\s/g, '_')}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            html2pdf().set(options).from(element).save();
        }
    </script>
</body>
</html>